package com.zhy.excel.venue;

import cn.hutool.core.util.StrUtil;
import cn.hutool.poi.excel.ExcelReader;
import cn.hutool.poi.excel.ExcelUtil;
import cn.hutool.poi.excel.ExcelWriter;
import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import org.junit.jupiter.api.Test;
import org.junit.platform.commons.util.StringUtils;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.atomic.AtomicInteger;

/**
 * @author zhouhongyin
 * @since 2022/5/23 10:38
 */
//@SpringBootTest
class VenueTest {


    @Test
    void mailType() {
        ExcelReader libReader = ExcelUtil.getReader("C:\\Users\\lenovo\\Desktop\\1.xlsx", 0);

        String sql = "INSERT INTO `pn_venue` (`name`, `address`, `avatar`, `cityId`, `regionId`, `latitude`, `longitude`, `latitudeBd`, `longitudeBd`, `phones`, `addTime`, `updateTime`, `latitude02`, `longitude02`, `parking`, `transportation`, `desc`, `status`, `operator`) VALUES ( '%s', '%s', NULL, %s, 0, 13.745443, 100.525915, NULL, NULL, '', '2024-11-05 10:26:36', '2024-11-05 10:26:36', NULL, NULL, NULL, NULL, '', 0, 'hongyin.zhou@ipiaoniu.com');";

        libReader.read().stream().forEach(row -> {

            System.out.printf(sql, row.get(0), row.get(1), row.get(2));

            System.out.println();
            System.out.println();

        });

    }

    @Test
    void test() {
        StringBuilder sb = new StringBuilder();
        List<String> readAll = new ArrayList<>();
        for (int i = 0; i < 3; i++) {
            sb.append(String.format("交易ID%s：%s 数量：%s\n", i, 121, 3434));
        }
        readAll.add(sb.toString());

        // 通过工具类创建writer
        ExcelWriter writer = ExcelUtil.getWriter("C:\\Users\\lenovo\\Desktop\\2.xlsx");
        // 一次性写出内容，使用默认样式，强制输出标题
        writer.write(readAll);
        // 关闭writer，释放内存
        writer.close();


    }


    @Test
    void category() {
        ExcelReader libReader = ExcelUtil.getReader("D:\\资料\\票牛\\需求文档\\0122\\pn_activitysubcategory.xlsx", 0);

        String sql = "";

        libReader.read().stream().forEach(row -> {

            System.out.printf(String.format("\"%s\": \"%s\",", row.get(0), row.get(4)));

            System.out.println();
            System.out.println();

        });

    }

    @Test
    void json() {
        String json = "{\"104\":\"0002000100020002\",\"6\":\"0002000100020002\",\"4\":\"0002000100020002\",\"3\":\"0002000100020003\",\"2\":\"0002000100020004\",\"1\":\"0002000100020002\",\"153\":\"0002000100020005\",\"150\":\"0002000100020006\",\"149\":\"0002000100020006\",\"147\":\"0002000100020007\",\"112\":\"0002000100020005\",\"102\":\"0002000100020005\",\"100\":\"0002000100020005\",\"96\":\"0002000100020005\",\"79\":\"0002000100010003\",\"13\":\"0002000100029999\",\"12\":\"0002000100029999\",\"11\":\"0002000100020001\",\"10\":\"0002000100029999\",\"9\":\"0002000100020008\",\"8\":\"0002000100020008\",\"7\":\"0002000100020005\",\"152\":\"0002000100020009\",\"127\":\"0002000100020009\",\"125\":\"0002000100020009\",\"124\":\"0002000100020009\",\"115\":\"0002000100020009\",\"106\":\"0002000100020009\",\"105\":\"0002000100020009\",\"99\":\"0002000100020009\",\"98\":\"0002000100020009\",\"91\":\"0002000100020009\",\"90\":\"0002000100020009\",\"89\":\"0002000100020009\",\"87\":\"0002000100020009\",\"69\":\"0002000100020009\",\"42\":\"0002000100020009\",\"103\":\"0002000100020006\",\"97\":\"0002000100020006\",\"92\":\"0002000100020006\",\"41\":\"0002000100020006\",\"40\":\"0002000100020006\",\"39\":\"0002000100020006\",\"131\":\"0002000200019999\",\"126\":\"0002000200019999\",\"109\":\"0002000200019999\",\"108\":\"0002000200019999\",\"82\":\"0002000200019999\",\"80\":\"0002000200019999\",\"78\":\"0002000200019999\",\"75\":\"0002000200019999\",\"73\":\"0002000200019999\",\"72\":\"0002000200019999\",\"28\":\"0002000200019999\",\"27\":\"0002000200019999\",\"26\":\"0002000200019999\",\"25\":\"0002000200019999\",\"24\":\"0002000200019999\",\"23\":\"0002000200019999\",\"22\":\"0002000200019999\",\"21\":\"0002000200019999\",\"132\":\"0002000100020007\",\"117\":\"0002000100020007\",\"116\":\"0002000100020007\",\"107\":\"0002000100020007\",\"93\":\"0002000100020007\",\"74\":\"0002000100020007\",\"33\":\"0002000100020007\",\"32\":\"0002000100020007\",\"31\":\"0002000100020007\",\"30\":\"0002000100020007\",\"29\":\"0002000100020007\",\"151\":\"0002000100020001\",\"148\":\"0002000100020001\",\"146\":\"0002000100020001\",\"134\":\"0002000100020001\",\"121\":\"0002000100020011\",\"110\":\"0002000100020011\",\"45\":\"0002000100020003,0002000100020005\",\"38\":\"0002000100020011\",\"37\":\"0002000100020011\",\"36\":\"0002000100020011\",\"35\":\"0002000100020001\",\"34\":\"0002000100020001\",\"123\":\"0002000100030003\",\"95\":\"0002000100030003\",\"86\":\"0002000100039999\",\"85\":\"0002000100039999\",\"84\":\"0002000100030003\",\"83\":\"0002000100030003\",\"71\":\"0002000100030003\",\"68\":\"0002000100039999\",\"66\":\"0002000100030001\",\"20\":\"0002000100039999\",\"19\":\"0002000100039999\",\"18\":\"0002000100030004\",\"17\":\"0002000100039999\",\"16\":\"0002000100030003\",\"15\":\"0002000100030003\",\"14\":\"0002000100030003\",\"135\":\"0002000200019999\",\"101\":\"0002000200020003\",\"64\":\"0002000200020008\",\"61\":\"0002000200029999\",\"60\":\"0002000200029999\",\"59\":\"0002000200029999\",\"58\":\"0002000200010003\",\"57\":\"0002000200020007\",\"56\":\"0002000200010001\",\"55\":\"0002000200029999\",\"53\":\"0002000200020012\",\"52\":\"0002000200020011\",\"51\":\"0002000200020007\",\"50\":\"0002000200010002\",\"49\":\"0002000200020008\",\"48\":\"0002000200020014\",\"47\":\"0002000200010007\",\"46\":\"0002000200010009,0002000200010003\",\"43\":\"0002000200029999\",\"145\":\"0002000200029999\",\"144\":\"0002000200029999\",\"143\":\"0002000200029999\",\"142\":\"0002000200029999\",\"130\":\"0002000200029999\",\"129\":\"0002000200029999\",\"128\":\"0002000200029999\",\"113\":\"0002000200029999\",\"65\":\"0002000200029999\",\"63\":\"0002000200029999\",\"62\":\"0002000200029999\",\"44\":\"0002000200029999\",\"5\":\"0002000200029999\"}";


        JSONObject jsonObject = JSON.parseObject(json);

        //System.out.println(jsonObject.get("2"));


        System.out.println(getCategory(3));


    }


    public static String getCategory(Integer subCategoryId) {
        if (subCategoryId == null) {
            return "000200010002";
        }
        String json = "{\"104\":\"0002000100020002\",\"6\":\"0002000100020002\",\"4\":\"0002000100020002\",\"3\":\"0002000100020003\",\"2\":\"0002000100020004\",\"1\":\"0002000100020002\",\"153\":\"0002000100020005\",\"150\":\"0002000100020006\",\"149\":\"0002000100020006\",\"147\":\"0002000100020007\",\"112\":\"0002000100020005\",\"102\":\"0002000100020005\",\"100\":\"0002000100020005\",\"96\":\"0002000100020005\",\"79\":\"0002000100010003\",\"13\":\"0002000100029999\",\"12\":\"0002000100029999\",\"11\":\"0002000100020001\",\"10\":\"0002000100029999\",\"9\":\"0002000100020008\",\"8\":\"0002000100020008\",\"7\":\"0002000100020005\",\"152\":\"0002000100020009\",\"127\":\"0002000100020009\",\"125\":\"0002000100020009\",\"124\":\"0002000100020009\",\"115\":\"0002000100020009\",\"106\":\"0002000100020009\",\"105\":\"0002000100020009\",\"99\":\"0002000100020009\",\"98\":\"0002000100020009\",\"91\":\"0002000100020009\",\"90\":\"0002000100020009\",\"89\":\"0002000100020009\",\"87\":\"0002000100020009\",\"69\":\"0002000100020009\",\"42\":\"0002000100020009\",\"103\":\"0002000100020006\",\"97\":\"0002000100020006\",\"92\":\"0002000100020006\",\"41\":\"0002000100020006\",\"40\":\"0002000100020006\",\"39\":\"0002000100020006\",\"131\":\"0002000200019999\",\"126\":\"0002000200019999\",\"109\":\"0002000200019999\",\"108\":\"0002000200019999\",\"82\":\"0002000200019999\",\"80\":\"0002000200019999\",\"78\":\"0002000200019999\",\"75\":\"0002000200019999\",\"73\":\"0002000200019999\",\"72\":\"0002000200019999\",\"28\":\"0002000200019999\",\"27\":\"0002000200019999\",\"26\":\"0002000200019999\",\"25\":\"0002000200019999\",\"24\":\"0002000200019999\",\"23\":\"0002000200019999\",\"22\":\"0002000200019999\",\"21\":\"0002000200019999\",\"132\":\"0002000100020007\",\"117\":\"0002000100020007\",\"116\":\"0002000100020007\",\"107\":\"0002000100020007\",\"93\":\"0002000100020007\",\"74\":\"0002000100020007\",\"33\":\"0002000100020007\",\"32\":\"0002000100020007\",\"31\":\"0002000100020007\",\"30\":\"0002000100020007\",\"29\":\"0002000100020007\",\"151\":\"0002000100020001\",\"148\":\"0002000100020001\",\"146\":\"0002000100020001\",\"134\":\"0002000100020001\",\"121\":\"0002000100020011\",\"110\":\"0002000100020011\",\"45\":\"0002000100020003,0002000100020005\",\"38\":\"0002000100020011\",\"37\":\"0002000100020011\",\"36\":\"0002000100020011\",\"35\":\"0002000100020001\",\"34\":\"0002000100020001\",\"123\":\"0002000100030003\",\"95\":\"0002000100030003\",\"86\":\"0002000100039999\",\"85\":\"0002000100039999\",\"84\":\"0002000100030003\",\"83\":\"0002000100030003\",\"71\":\"0002000100030003\",\"68\":\"0002000100039999\",\"66\":\"0002000100030001\",\"20\":\"0002000100039999\",\"19\":\"0002000100039999\",\"18\":\"0002000100030004\",\"17\":\"0002000100039999\",\"16\":\"0002000100030003\",\"15\":\"0002000100030003\",\"14\":\"0002000100030003\",\"135\":\"0002000200019999\",\"101\":\"0002000200020003\",\"64\":\"0002000200020008\",\"61\":\"0002000200029999\",\"60\":\"0002000200029999\",\"59\":\"0002000200029999\",\"58\":\"0002000200010003\",\"57\":\"0002000200020007\",\"56\":\"0002000200010001\",\"55\":\"0002000200029999\",\"53\":\"0002000200020012\",\"52\":\"0002000200020011\",\"51\":\"0002000200020007\",\"50\":\"0002000200010002\",\"49\":\"0002000200020008\",\"48\":\"0002000200020014\",\"47\":\"0002000200010007\",\"46\":\"0002000200010009,0002000200010003\",\"43\":\"0002000200029999\",\"145\":\"0002000200029999\",\"144\":\"0002000200029999\",\"143\":\"0002000200029999\",\"142\":\"0002000200029999\",\"130\":\"0002000200029999\",\"129\":\"0002000200029999\",\"128\":\"0002000200029999\",\"113\":\"0002000200029999\",\"65\":\"0002000200029999\",\"63\":\"0002000200029999\",\"62\":\"0002000200029999\",\"44\":\"0002000200029999\",\"5\":\"0002000200029999\"}";

        JSONObject jsonObject = JSON.parseObject(null);

        if (jsonObject == null || StringUtils.isBlank(jsonObject.getString(String.valueOf(subCategoryId)))) {
            return "000200010002";
        } else {
            return jsonObject.getString(String.valueOf(subCategoryId));
        }
    }




}
